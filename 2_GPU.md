# GPU

*仅介绍少数用于深度学习的GPU，其他关于GPU的知识暂不介绍*

&nbsp;

## GPU的种类（N和A）

显卡无论是Nvidia还是AMD，都有游戏显卡、计算卡和专业图形卡之分

显卡AI性能天梯：https://lambdalabs.com/gpu-benchmarks

&nbsp;

###  **常见的显卡架构**

|  显卡架构  |    游戏显卡    |               TITAN               |               计算卡               |      专业图形卡      |
| :---------: | :------------: | :--------------------------------: | :---------------------------------: | :-------------------: |
| **Ada Lovelace架构** | **RTX 4090 24GB** | - | - | **NVIDIA RTX 6000 Ada Generation 48GB** |
| **Hopper架构** | - | - | **NVIDIA H100 80GB** | - |
| Ampere架构 | RTX 3090Ti 24GB | - | NVIDIA A100 40/80GB | NVIDIA RTX A6000 48GB |
| Turing架构 | RTX 2080Ti 11GB | TITAN RTX 24GB | Tesla T4 16GB | Quadro RTX 8000 48GB |
| Volta架构 | - | TITAN V 12/32GB | Tesla V100(S) 16/32GB | Quadro GV100 32GB |
| Pascal架构 | GTX 1080Ti 11GB | TITAN X(Pascal) 12GB,TITAN Xp 12GB | Tesla P100 16GB,Tesla P40 24GB | Quadro P6000 24GB |
| Maxwell架构 |  GTX 980Ti 6GB  |            GTX TITAN X 12GB            |           Tesla M40 24GB           |   Quadro M6000 12GB   |

图形卡和游戏卡、TITAN的规格差不多，如RTX8000基本上就是TITAN RTX的显存增大版，但价格往往贵了很多，因此买2张TITAN RTX比1张RTX 8000更划算

&nbsp;

### **游戏显卡部分（推荐）**

注意：40系全部都是向上进风（即显卡的风扇吸风）

|  **NVIDIA-40系**  | CUDA核心/Tensor核心及数量 | 参考价格 | 常见功耗/w |
| :------------------: | :-----------------------: | :------: | :--------: |
|  RTX 4060 8G   |   AD107-400-A1，3072个    |   2399   |    115     |
|  RTX 4060Ti 8G   |   AD106-350-A1，4352个    |   3199   |    160     |
|  RTX 4070 12G   |   AD104-250-A1，5888个    |   4799   |    200     |
|  RTX 4070Ti 12G   |   AD104-400-A1，7680个    |   6599   |    285     |
|   RTX 4080 16G    |   AD103-300-A1，9728个    |   9499   |    320     |
|   RTX 4090 24G    |   AD102-300-A1，16384个   |  12999   |    450     |
| RTX 6000 Ada 48GB |      AD102，18176个       |  52000   | 300&nbsp;  |

注意：

**1、对于10系（包括TITAN Xp，TITAN X，GP100，Telsa P40）或更古老的显卡来说，CUDA核心不能简单叠加，需要考虑显存带宽、散热之类的**

2、支持PCIe 4.0的显卡有：

Ampere架构的全部显卡（RTX3090、A100、A6000），比Ampere更新的全部架构，但需要主板和CPU均支持PCIe 4.0，显卡才能运行在PCIe 4.0的设置下。目前已知的只有Z690、B660、Z590、B560和X570、B550、TRX40、WRX40芯片组的主板支持PCIe4.0，部分Z490、X470、B450支持PCIe 4.0但需要刷BIOS，目前已知至少要11代酷睿、3000系锐龙、3000系的线程撕裂者和Zen2架构的霄龙才支持PCIe4.0。

3、显存决定了能否运行，而CUDA核心数量、显存频率、显存种类、显卡带宽决定了运行速度

4、10系和20系移动端显卡和台式机的显卡性能基本一致，9系和30、40系的不一样

（个别显卡只有笔记本才有，比如GTX1650Ti，以及MaxQ显卡，MaxQ显卡规模一样，但被设置了更低的功耗墙，因此跑深度学习时较同样的桌面级显卡要差一些）

&nbsp;

### **计算卡**（推荐）

7系：Tesla K80 24G

9系：Tesla M40 12G/24G，Tesla M4 4G

10系：Tesla P100 16G，Tesla P40 24G，Tesla P4 8G

20系：Tesla T4 16G，Tesla V100 16G/32G

30系：NVIDIA A100 40/80GB，NVIDIA A40 48GB

40系：NVIDIA H100 80GB

&nbsp;

### 图形卡

图形卡不建议购买，除非是预算有很多，但PCIe数量极其有限

| **NVIDIA-**Ada Lovelace 微架构**（40系）** | **CUDA核心/Tensor核心及数量** | **常见功耗/w** | **FP32运算性能/TFLOPS** |
| :----------------------------------------: | :---------------------------: | :------------: | :---------------------: |
|        RTX 6000 Ada Generation 48GB        |         AD102，18176          |      300       |          91.06          |
|      **NVIDIA-Ampere 微架构（30系）**      | **CUDA核心/Tensor核心及数量** | **常见功耗/w** | **FP32运算性能/TFLOPS** |
|                RTX A2000 6G                |        GA106-850，3328        |       70       |          7.987          |
|               RTX A2000 12G                |        GA106-850，3328        |       70       |          7.987          |
|                RTX A3000 6G                |          GA104，4096          |      130       |          12.8           |
|               RTX A4000 16G                |        GA104-875，6144        |      140       |          19.17          |
|               RTX A4500 20G                |          GA102，7168          |      200       |          23.7           |
|               RTX A5000 24G                |        GA102-850，8192        |      230       |         27.772          |
|               RTX A5500 24G                |       GA102-8xx，10240        |      230       |          34.1           |
|               RTX A6000 48G                |       GA102-875，10752        |      300       |         38.709          |
|      **NVIDIA-Turing 微架构（20系）**      | **CUDA核心/Tensor核心及数量** | **常见功耗/w** | **FP32运算性能/TFLOPS** |
|                RTX 4000 8G                 |        TU104-850，2304        |      160       |           7.1           |
|                RTX 5000 16G                |        TU104-875，3072        |      265       |          11.2           |
|                RTX 6000 24G                |        TU102-875，4608        |      295       |          16.3           |
|                RTX 8000 48G                |        TU102-875，4608        |      295       |          16.3           |

&nbsp;

## GPU的搭配（主板、CPU、硬盘、网卡、散热、机箱、电源）

**0显卡**

多路显卡推荐双槽位的显卡，已知的有：

全部的公版卡（注意RTX3090公版是三槽卡）

**华硕（ASUS）TURBO-RTX2080TI-11GD6-DL**

**技嘉（GIGABYTE）RTX2080Ti TURBO 11G**

**技嘉（GIGABYTE）RTX3090 TURBO 24G**

&nbsp;

**1 主板**

主板最好是选供电高端的，具体如何挑选请看主板篇

另外记得，例如X570，Z490这种主流游戏主板，最多接2张显卡，X299，TRX40，X399，C246，C422这些高端主板，最多接4张显卡，C612，C621，C622，最多接6张显卡

&nbsp;

**2 CPU**

CPU使用参考第一个文档

&nbsp;

**3 硬盘**

对于大数据集，使用固态硬盘能加速数据读取速度，就目前来看是选SATA还是选M.2，对GPU影响不大

不过选机械硬盘肯定要慢一点（大部分模型都卡在“读”上）

&nbsp;

**4 网卡**

能用外置网卡就用外置网卡，GPU对集成网卡的散热有一定影响

&nbsp;

**5 散热**

GPU的散热有两种，涡轮散热和风扇散热。计算卡和图形卡基本上是涡轮散热，因此基本是一张卡2槽位，ATX主板可以放下4张卡

使用风扇散热的可能要2.5-3槽位，因此一个ATX主板将只能放下2-3张卡

对于深度学习而言，涡轮散热比风扇散热好

&nbsp;

**6 机箱**

尽可能选体积大的机箱，比如追风者P600这种

&nbsp;

**7 电源**

单卡电源不得小于650w，双卡电源不得小于850w，三卡电源不得小于1200w

四卡电源不得小于2000w，八卡电源不得小于2000w*2

&nbsp;

## 多路GPU

**SLI有无帮助？**

无，SLI是两张卡交叉渲染（SLI一般是游戏显卡支持，比如980Ti和1080Ti或者早期的TITAN，比如TITAN V和TITAN Xp）

**NVLink有无帮助？**

有，但支持NVLink的显卡很少，而且通常的NVLink最多支持2张显卡。检查显卡是否支持NVLink需要去官网查询（一般是图形卡和TITAN支持）

https://en.wikipedia.org/wiki/NVLink 可通过此网站查阅NVLink的适配性和带宽，游戏卡中仅有2080，2080S，2080Ti，3090支持NVLink

一般而言NVLink要远远快于PCIe 4.0x16

**一般情况下的三卡以及更多的卡怎么进行数据交换呢？**

走PCIe通道，注意有些PCIe是CPU直连，有些是PCH扩展出来的，因此进行数据交换的时候PCIe通道的数量可能是瓶颈

&nbsp;

## GPU的软件适配（深度学习的特点）

在跑深度学习的时候，尽可能的关掉后台程序

&nbsp;

## GPU的注意事项（N卡和CUDA）

不要爆显存，不要超频

&nbsp;

## GPU的价格（选购和捡垃圾）

20系显卡选购的时候注意不要低于上面的参考价格，那基本上是各种矿卡、来路不明的二手显卡

GPU的品牌厂家：

超一线：公版显卡

一线品牌：华硕，技嘉，微星，EVGA，丽台

二线品牌：七彩虹，索泰，影驰，耕升，铭瑄，讯景，映众，

三线品牌：盈通，昂达，翔升，华擎，映泰（三线品牌可能会阉割显存）

垃圾品牌：铭影，小影霸，铭速，精影

&nbsp;
二手显卡推荐GTX1070Ti，GTX1080Ti，GTX1070，GTX980Ti
